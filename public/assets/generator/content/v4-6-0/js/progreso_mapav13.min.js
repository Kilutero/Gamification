!function(){function t(){n=n||setInterval(e,6e5),$.ajax({async:!1,type:"POST",url:"../../contentunit/php/funcioneslaltiv3.php",data:{function:0},error:function(e){if(401!=e.status){let t="ERROR T1: SESIÓN CADUCADA. DEBES ENTRAR NUEVAMENTE EN EL AULA VIRTUAL Y LANZAR LA UNIDAD.";400==e.status&&(t="ADVERTENCIA T1: ¡TIENES UNA UNIDAD DE EVALUACIÓN ABIERTA!"),i(t,2)}else $("#message").removeClass("oculto"),o()}}).done(function(){o()})}function e(){$.ajax({async:!1,type:"POST",url:"../../contentunit/php/funcioneslaltiv3.php",data:{function:5},error:function(e){if(401!=e.status){let t="ERROR T2: SESIÓN CADUCADA. DEBES ENTRAR NUEVAMENTE EN EL AULA VIRTUAL Y LANZAR LA UNIDAD.";400==e.status&&(t="ADVERTENCIA T2: ¡TIENES UNA UNIDAD DE EVALUACIÓN ABIERTA!"),i(t,2)}else $("#message").removeClass("oculto")}})}let n,s=$("body").data("objectives"),a=$("body").data("unit");function o(){$("#sharedModal").modal("hide"),$("#sharedModal").empty()}let i=function(t,e){switch(e){case 1:$("#sharedModal").append('<div class="cargando" style="height:100%; width:100%; position: absolute; z-index: 10000; background-color: rgba(0, 0, 0, 0.5); top: 0;"><div class="text-center" style="position: absolute; top: 30%; left: 47%;"><i class="fa fa-spinner fa-spin fa-3x" aria-hidden="true"></i><p class="white" style="color:white;"><strong>'+t+"</strong></p></div></div>");break;case 2:$("#sharedModal").append('<div class="cargando" style="height:100%; width:100%; position: absolute; z-index: 10000; background-color: rgba(0, 0, 0, 0.5); top: 0;"><div class="text-center" style="position: absolute; top: 30%; left: 25%;"><i class="fa fa-exclamation-triangle fa-3x" aria-hidden="true"></i><p class="white" style="color:white;"><strong>'+t+"</strong></p></div></div>")}$("#sharedModal").modal({backdrop:!1,show:!0})};let A=function(t){for(var e="",n=0;n<s.length;n++)for(var a=0;a<s[n].length;a++)s[n][a]._id==t&&(e=s[n][a]._porcentaje);return e};let r=function(t){var e=!1;return e=100==A(t)?!0:e},l=function(t){if(null==s[t-1])return NaN;for(var e=0,n=0;n<s[t-1].length;n++)100==A(s[t-1][n]._id)&&e++;return parseInt(e/s[t-1].length*100)};var E=$("#progreso_mp");function c(){E.find(".progress-bar").each(function(e){var t=0!=s[e].length,n=l(e+1);$(this).html(t?n:""),$(this).attr("aria-valuenow",t?n:"100"),$(this).css("width",t?n+"%":"100%");for(let t=0;t<s[e].length;t++)r(s[e][t]._id)&&($("#"+s[e][t]._id).removeClass("far"),$("#"+s[e][t]._id).addClass("fas"),$("#"+s[e][t]._id).addClass("visto"))})}$(document).on("visibilitychange",function(){"hidden"===document.visibilityState?(n&&clearInterval(n),n=null,$.ajax({async:!0,type:"POST",url:"../../contentunit/php/funcioneslaltiv3.php",data:{function:1}})):t()}),i("Cargando Objetivos",1),setTimeout(c,100),setTimeout(configurarElementosControl,500),t(),window.setObjetivoCompleto=function(t,e,n){if(!r(t)){for(var a=0;a<s.length;a++)for(var o=0;o<s[a].length;o++)s[a][o]._id==t&&(s[a][o]._porcentaje=100,$.ajax({async:!0,type:"POST",url:"../../contentunit/php/funcionesobjetivoltiv4.php",data:{objetivo:JSON.stringify({id:s[a][o].id,nombre:s[a][o]._id})},error:function(e){if(401!=e.status){let t="ERROR T6: SESIÓN CADUCADA. DEBES ENTRAR NUEVAMENTE EN EL AULA VIRTUAL Y LANZAR LA UNIDAD.";400==e.status&&(t="ADVERTENCIA T6: ¡TIENES UNA UNIDAD DE EVALUACIÓN ABIERTA!"),i(t,2)}else $("#message").removeClass("oculto")}}),$.ajax({async:!0,type:"POST",url:"../../contentunit/php/funcioneslaltiv3.php",data:{function:3,element:t,notes:n,namevideo:e},error:function(e){if(401!=e.status){let t="ERROR T4: SESIÓN CADUCADA. DEBES ENTRAR NUEVAMENTE EN EL AULA VIRTUAL Y LANZAR LA UNIDAD.";400==e.status&&(t="ADVERTENCIA T4: ¡TIENES UNA UNIDAD DE EVALUACIÓN ABIERTA!"),i(t,2)}else $("#message").removeClass("oculto")}}));c()}},window.startGame=function(t,e){$.ajax({async:!1,type:"POST",url:"../../contentunit/php/funcionesGamev2.php",data:{idunidad:a,idwidget:t,origin:e},error:function(e){if(401!=e.status){let t="ERROR T2: SESIÓN CADUCADA. DEBES ENTRAR NUEVAMENTE EN EL AULA VIRTUAL Y LANZAR LA UNIDAD.";400==e.status&&(t="ADVERTENCIA T2: ¡TIENES UNA UNIDAD DE EVALUACIÓN ABIERTA!"),i(t,2)}else $("#message").removeClass("oculto")},success:function(t){t="https://game.upct.es/"+JSON.parse(t).codgame+"/teacher/";location.replace(t,"_blank")}})},window.setObjetivoInteraccion=function(t,e,n){for(var a=0;a<s.length;a++)for(var o=0;o<s[a].length;o++)s[a][o]._id==t&&$.ajax({async:!1,type:"POST",url:"../../contentunit/php/funcioneslaltiv3.php",data:{function:2,element:t,notes:n,namevideo:e},error:function(e){if(401!=e.status){let t="ERROR T5: SESIÓN CADUCADA. DEBES ENTRAR NUEVAMENTE EN EL AULA VIRTUAL Y LANZAR LA UNIDAD.";400==e.status&&(t="ADVERTENCIA T5: ¡TIENES UNA UNIDAD DE EVALUACIÓN ABIERTA!"),i(t,2)}else $("#message").removeClass("oculto")}})}}();