var correctas=0,porcentajes=0,numeroPreguntas=0,respuestascorrectas=new Array,notas=new Array;function inicializar(){inicializarEvaluacion(),inicializarPreguntas(),numeroPreguntas=enunciados.length-1,$("#buttonSubmit").click(btEnviarClick),$("#preguntas").hide(),$("#resultados").hide(),-1==nota?($("#infoEvaluacion").html("<h4>"+language[3]+"</h4>"),$("#preguntas").show()):($("#encabezadoEvaluacion").html("<br><h3 class='centered'>"+language[5]+" "+nota+"</h3>"),$("#buttonSubmit").hide()),$(".grade").html(nota),$("body").on("click","a.list-group-item",pulsarRepuesta)}$(document).ready(function(){inicializar()});var pulsarRepuesta=function(e){e.preventDefault();var t=$(this).parent(),s=$(this).attr("data-value");numPregunta=t.attr("data-value");e=tipoPreguntas[numPregunta];0==e||2==e?($(".respuesta",t).each(function(e){$(this).removeClass("respuestaColorSelected")}),$(this).addClass("respuestaColorSelected"),respuestasEstudiante[numPregunta].pop(),respuestasEstudiante[numPregunta].push(s)):($(this).toggleClass("respuestaColorSelected"),respuestasEstudiante[numPregunta].includes(s)?respuestasEstudiante[numPregunta].splice(respuestasEstudiante[numPregunta].indexOf(s),1):respuestasEstudiante[numPregunta].push(s));var a=!0;for(i=1;i<=numeroPreguntas;i++)0==respuestasEstudiante[i].length&&(a=!1);a&&$("#buttonSubmit").attr("disabled",!1)},desactivado=function(e){e.preventDefault()};function mostrarFeedback(){respuestasEstudiante.shift();var e=0;for(i=0;i<=numeroPreguntas-1;i++){if(respuestasEstudiante[i].length==respuestascorrectas[i].length){for(e=1,j=0;j<respuestasEstudiante[i].length;j++)if(!respuestascorrectas[i].includes(respuestasEstudiante[i][j])){e=0;break}}else e=0;if(1==e){for(j=0;j<respuestasEstudiante[i].length;j++)$("#respuesta"+(i+1)+respuestasEstudiante[i][j]).css("border","solid 3px #4bbb8b");$("#feedbackCorrecto"+(i+1)).show()}else $("#feedbackIncorrecto"+(i+1)).show()}}function btEnviarClick(e){e.preventDefault(),$("body").off("click","a.list-group-item").on("click","a.list-group-item",desactivado),$("a.list-group-item").addClass("disabled"),$(".respuesta").css("cursor","default"),$("#buttonSubmit").hide(),comprobar()}function comprobar(){var e=new Array;for(i in respuestasEstudiante)e[i]=respuestasEstudiante[i];e.shift(),e=JSON.stringify(e),$.ajax({url:"./respuestas.php",type:"POST",dataType:"json",data:{respEstudiantes:e,numPreguntas:numeroPreguntas,objetivo:JSON.stringify({id:objetivos.id})},success:function(e){respuestascorrectas=e[0],notas=e[1],mostrarFeedback(),respuestasFinal()},error:function(e){401!=e.status?bloquearInteraccion("ERROR T6: SESIÓN CADUCADA. DEBES ENTRAR NUEVAMENTE EN EL AULA VIRTUAL Y LANZAR LA UNIDAD.",2):bloquearInteraccion("ERROR T6: ¡TIENES VARIAS UNIDADES ABIERTAS! NO PUEDES REALIZAR LA EVALUACIÓN CON OTRAS UNIDADES ABIERTAS.",2)}})}function respuestasFinal(){var e=notas.length;if(0==e)html+="<li>Sin resultados coincidentes</li>";else for(var t=0;t<e;t++)HTMLcontent="",HTMLcontent+="<div class='col-md-8'><p>"+language[4]+"</p>",$("#resultados").html(HTMLcontent),$("#resultados").show(),HTMLcontent="",HTMLcontent+="<div class='col-md-12'><p><strong>"+language[0].replace("P1",notas[t].aciertos).replace("P2",numeroPreguntas)+"</strong></p><p>"+language[2]+"<strong> "+notas[t].porcentajes+"</strong> / "+language[1]+"<strong> "+notas[t].porcentajes1+"</strong></p>",$("#resultados").html(HTMLcontent),$("#resultados").show()}